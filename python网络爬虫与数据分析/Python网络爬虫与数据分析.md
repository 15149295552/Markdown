# Python网络爬虫

## 1、背景

问题1：网络上形形色色的图片、音频、视频；丰富的文章及小说；绚丽的PPT等素材，同时也包括我们生活中使用的APP，那这些都是数据吗？

问题2：何为数据？大数据那就是大，其实也不完全是，其实它还包含了多维度。

问题3：:这些数据都是从哪里来的呢？

- 公司的自我积累
- 第三方平台购买
- 获取的公开数据
- 网络爬虫

> Python网络爬虫就是一种【数据获取】技术。

问题4：Python网络爬虫合法吗？

- 负面新闻：一个程序员因为编写了一个网络爬虫，导致公司200多人被抓。

问题5：Python网络爬虫可以获取哪些数据？

- 其实网络上展示的都是可以爬取的，但要：**合理合法** 

---

## 2、概念

又称：爬虫蜘蛛，网络机器人

按照一定规则从万维网上爬取所需数据的**程序**或脚本。

## 3、目的

1、业务需求 - 今日头条

2、用于数据分析

## 4、优势

1. Python ：请求模块、解析模块丰富成熟，强大的Scrapy网络爬虫框架 
2. PHP ：对多线程、异步支持不太好 
3. JAVA：代码笨重,代码量大 
4. C/C++：虽然效率高,但是代码成型慢

## 5、分类

1. 通用网络爬虫：搜索引擎使用，遵守 robots协议【SEO】
2. **聚焦网络爬虫** ：指定某个网址编写的爬虫程序

## 6、流程

1、确定URL地址

​	https://www.baidu.com   --> URL 

2、发送请求，获取响应

3、数据清洗（从大量的数据中解析出我们想要的数据）

4、数据存储（文件、数据库）

5、数据分析（数据标准化、数据分析方法、数据建模、数据可视化、数据分析报告、落地实施）

## 7、请求模块

- 安装：python -m pip install requests

- GET请求：**requests.get(url, kwargs)**

- 响应属性：

  ```python
  【1】text              ：字符串
  【2】content        ：字节流
  【3】status_code ：HTTP响应码
  【4】url                ：实际数据的URL地址
  ```

## 8、数据解析模块-re

- **正则表达式 - re**

  - 概念：描述了一种字符串匹配的模式

  - 作用：用来检查一个串是否含有某种子串、将匹配的子串替换或者从某个串中取出符合某个条件的子串

  - **元字符**

    | 元字符 | 含义                      |
    | ------ | :------------------------ |
    | .      | 任意一个字符（不包括 \n） |
    | \d     | 一个数字                  |
    | \s     | 空白字符                  |
    | \S     | 非空白字符                |
    | []     | 包含[]内容                |
    | *      | 出现0次或多次             |
    | +      | 出现1次或多次             |

  - **方法**

    - re.search(pattern, string, flags=0)
    - re.findall(pattern, string, flags=0)

  - **分组**

    - 在完整的模式中定义子模式，将每个圆括号中子模式匹配出来的结果提取出来

----

问题：从html代码结构中完成如下内容信息的提取：

```html
<div class="animal">
    <p class="name">
        <a title="Tiger"></a>
    </p>

    <p class="content">
        Two tigers two tigers run fast
    </p>
</div>

<div class="animal">
    <p class="name">
        <a title="Rabbit"></a>
    </p>

    <p class="content">
        Small white rabbit white and white
    </p>
</div>
```

提取的结果1：[('Tiger',' Two...'),('Rabbit','Small..')]

提取的结果2：

	动物名称 ：Tiger
	动物描述 ：Two tigers two tigers run fast
	**********************************************
	动物名称 ：Rabbit
	动物描述 ：Small white rabbit white and white
## 9、数据存储

- 文件操作

  - 1、打开文件
    - 文件对象 = open(文件路径, 模式)
  - 2、读写操作
    - 文件对象.read()
    - 文件对象.write(字符串)
  - 3 关闭文件
    - 文件对象.close()

- 总结

  ```PYTHON
  写操作：
  	如果文件不存在，创建文件，写入数据
  	如果文件存在，覆盖原有数据
  	场景：最后将所有的数据一次性写入
      
  追加操作：
  	如果文件不存在，创建文件，写入数据
  	如果文件存在，在原有数据后追加
  	场景：数据追加
      
  读模式
  	注意：读取的文件必须存在
  	read方法：将文件中的所有数据一次性读取处理，返回的字符串类型
  ```
